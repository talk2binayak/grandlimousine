/*! Fleet Manager - v2.0.5
 * https://iworks.pl/
 * Copyright (c) 2022; * Licensed GPLv2+ */

jQuery(document).ready(function(a){a(function(){a(".iworks-fleet-row .datepicker").each(function(){var b=a(this).data("date-format")||"yy-mm-dd";a(this).datepicker({dateFormat:b})})})}),jQuery(document).ready(function(a){var b=[],c={action:"iworks_fleet_persons_list",_wpnonce:iworks_fleet.nonces.iworks_fleet_persons_list_nonce,user_id:iworks_fleet.user_id};a.post(ajaxurl,c,function(c){c.success&&(b=c.data,a("select",a("#iworks-crews-list")).select2({data:b}),a("select",a(".iworks-owners-list-container tbody")).each(function(){var c=b;a(this).select2({data:c})}))}),a(function(){a(".iworks-add-crew").on("click",function(){var c=a("#iworks-crews-list"),d=Date.now(),e=wp.template("iworks-boat-crew");return c.append(e({id:d})).ready(function(){var c=a("#iworks-crew-"+d);a("select",c).select2({data:b})}),!1})});var d=a(".iworks-owners-list-container tbody"),e=parseInt(a("#iworks_fleet_boat_build_year").val()),f=function(a){a.datepicker({changeMonth:!0,changeYear:!0,showButtonPanel:!0,yearRange:0<e?e+":+0":"1955:+0",dateFormat:a.data("date-format")||"yy-mm-dd"})},g=function(c){c.on("click",function(){var c=a(this).closest("td"),d=wp.template("iworks-fleet-boat-owner-user"),e=a(this).closest("tr").data("id");return a(".persons",c).append(d({id:e})).ready(function(){var c=b;a(".select2.empty").select2({data:c}).removeClass("empty")}),!1})},h=function(b){b.on("change",function(){var c=a(this).closest("tr");"organization"===b.val()?(a("div.person",c).hide(),a("div.organization",c).show()):(a("div.person",c).show(),a("div.organization",c).hide())})};a(".boat-kind input",d).each(function(){h(a(this))}),a("a.iworks-fleet-boat-delete",d).on("click",function(){return a(this).closest("tr").detach(),!1}),a(".datepicker",d).each(function(){f(a(this))}),g(a("a.add-person-selector",d)),a("#iworks-owners-list-add").on("click",function(){var c=wp.template("iworks-fleet-boat-owner"),e="iworks-fleet-boat-owner-"+Date.now(),i=b;return d.append(c({id:e,kind:"person"})).ready(function(){var b=a('tr[data-id="'+e+'"]');a(".boat-kind input",b).each(function(){h(a(this))}),a("input[type=radio][value=person]",b).attr("checked","checked"),a(".person",b).show(),c=wp.template("iworks-fleet-boat-owner-user"),a(".persons",b).append(c({id:e})),g(a("a.add-person-selector",b)),a("a.iworks-fleet-boat-delete",b).on("click",function(){return a(this).closest("tr").detach(),!1}),a("select",b).select2({data:i}),a(".datepicker",b).each(function(){f(a(this))})}),!1})}),jQuery(document).ready(function(a){}),jQuery(document).ready(function(a){a(function(){a(".post-type-iworks_fleet_result #race button").on("click",function(b){b.preventDefault();var c=new FormData,d=a(this).closest(".inside"),e=!1;if(a.each(a("#file_fleet_races")[0].files,function(a,b){e=!0,c.append("file",b,b.name)}),!e)return void window.alert(iworks_fleet.messages.result.choose_file_first);c.append("action","iworks_fleet_upload_races"),c.append("id",a("#post_ID").val()),c.append("_wpnonce",a("#iworks_fleet_posttypes_result").val());var c={url:ajaxurl,method:"POST",type:"POST",cache:!1,data:c,contentType:!1,processData:!1};return a(".spinner",d).css("display","block").css("float","left").css("visibility","visible"),a("#file_fleet_races, button",d).attr("disabled","disabled").addClass("disabled"),a.ajax(c).success(function(b){a("#file_fleet_races, button",d).removeAttr("disabled").removeClass("disabled"),a(".spinner",d).hide()}),!1})})}),jQuery(document).ready(function(a){a("select.iworks-select2").select2()});